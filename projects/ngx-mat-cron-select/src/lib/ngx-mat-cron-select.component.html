<div class="ngx-mat-cron-select">
  <mat-tab-group [selectedIndex]="selectedTab()" (selectedIndexChange)="manuallySelectedTab.set($event)">
    <mat-tab [label]="('tabLabelHour' | translateOrUseDefault | async) ?? ''">
      @if (selectedTab() === ECronSelectTab.hour) {
        <div class="vertical-flex-with-gap">
          <nmcs-minute-select
            class="fixed-width-select"
            [formControl]="inputsFormGroup().controls.minute"
            [everyMinuteFormControl]="everyCheckboxesFormGroup().controls.minute"
            [isEveryMinuteCheckboxVisible]="true"
          ></nmcs-minute-select>
        </div>
      }
    </mat-tab>
    <mat-tab [label]="('tabLabelDay' | translateOrUseDefault | async) ?? ''">
      @if (selectedTab() === ECronSelectTab.day) {
        <div class="vertical-flex-with-gap">
          <ng-template [ngTemplateOutlet]="hourAndMinuteSelect"></ng-template>
        </div>
      }
    </mat-tab>
    <mat-tab [label]="('tabLabelWeek' | translateOrUseDefault | async) ?? ''">
      @if (selectedTab() === ECronSelectTab.week) {
        <div class="vertical-flex-with-gap">
          <ng-template [ngTemplateOutlet]="hourAndMinuteSelect"></ng-template>
          <nmcs-day-of-week-select
            class="fixed-width-select"
            [formControl]="inputsFormGroup().controls.dayOfWeek"
            [everyDayFormControl]="everyCheckboxesFormGroup().controls.day"
            [isEveryDayCheckboxVisible]="true"
          ></nmcs-day-of-week-select>
        </div>
      }
    </mat-tab>
    <mat-tab [label]="('tabLabelMonth' | translateOrUseDefault | async) ?? ''">
      @if (selectedTab() === ECronSelectTab.month) {
        <div class="vertical-flex-with-gap">
          <ng-template [ngTemplateOutlet]="hourAndMinuteSelect"></ng-template>
          <nmcs-day-of-month-select
            class="fixed-width-select"
            [formControl]="inputsFormGroup().controls.dayOfMonth"
            [everyDayFormControl]="everyCheckboxesFormGroup().controls.day"
            [isEveryDayCheckboxVisible]="true"
          ></nmcs-day-of-month-select>
        </div>
      }
    </mat-tab>
    <mat-tab [label]="('tabLabelYear' | translateOrUseDefault | async) ?? ''">
      @if (selectedTab() === ECronSelectTab.year) {
        <div class="vertical-flex-with-gap">
          <ng-template [ngTemplateOutlet]="hourAndMinuteSelect"></ng-template>
          <div class="side-by-side-container">
            @for (monthOrDay of monthAndDayOrder; track monthOrDay) {
              @if (monthOrDay === 'day') {
                <nmcs-day-of-month-select
                  class="fixed-width-select"
                  [formControl]="inputsFormGroup().controls.dayOfMonth"
                  [everyDayFormControl]="everyCheckboxesFormGroup().controls.day"
                  [isEveryDayCheckboxVisible]="true"
                ></nmcs-day-of-month-select>
              } @else {
                <nmcs-month-of-year-select
                  class="fixed-width-select"
                  [formControl]="inputsFormGroup().controls.monthOfYear"
                  [everyMonthFormControl]="everyCheckboxesFormGroup().controls.monthOfYear"
                  [isEveryMonthCheckboxVisible]="true"
                ></nmcs-month-of-year-select>
              }
            }
          </div>
        </div>
      }
    </mat-tab>
  </mat-tab-group>
</div>

<ng-template #hourAndMinuteSelect>
  <div class="side-by-side-container">
    <nmcs-hour-select
      class="fixed-width-select"
      [formControl]="inputsFormGroup().controls.hour"
      [everyHourFormControl]="everyCheckboxesFormGroup().controls.hour"
      [isEveryHourCheckboxVisible]="true"
    ></nmcs-hour-select>
    <nmcs-minute-select
      class="fixed-width-select"
      [formControl]="inputsFormGroup().controls.minute"
      [everyMinuteFormControl]="everyCheckboxesFormGroup().controls.minute"
      [isEveryMinuteCheckboxVisible]="true"
    ></nmcs-minute-select>
  </div>
</ng-template>
